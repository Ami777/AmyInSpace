!function t(e,o,i){function a(r,s){if(!o[r]){if(!e[r]){var h="function"==typeof require&&require;if(!s&&h)return h(r,!0);if(n)return n(r,!0);var l=new Error("Cannot find module '"+r+"'");throw l.code="MODULE_NOT_FOUND",l}var d=o[r]={exports:{}};e[r][0].call(d.exports,function(t){var o=e[r][1][t];return a(o?o:t)},d,d.exports,t,e,o,i)}return o[r].exports}for(var n="function"==typeof require&&require,r=0;r<i.length;r++)a(i[r]);return a}({1:[function(t,e,o){"use strict";var i=t("./game");window.onload=function(){new i["default"]}},{"./game":4}],2:[function(t,e,o){"use strict";o.DEBUG=!1,o.LEVELS_COUNT=31},{}],3:[function(t,e,o){"use strict";var i=t("./gameMap"),a=t("./config"),n=function(){function t(t,e,o){var i=this;this.gameMgr=t,this.game=e,this.followMode=!1,this.movingInterval=0,this.wallTouchCount=0,this.noHurt=!1,this.randomMoveCurrDir=null;var a=Math.round(5*Math.random()+1);switch(this.sprite=this.game.add.sprite(o.x,o.y,"zombie"+a),a){case 1:this.AIConfig={name:"Dumb",wallTouchToAbandonFollowMode:250,randomMovingInterval:1e3,randomMovingTimeout:6e3,speedIdle:125,speedFollowPlayer:160};break;case 2:this.AIConfig={name:"Balanced",wallTouchToAbandonFollowMode:150,randomMovingInterval:1e3,randomMovingTimeout:4e3,speedIdle:125,speedFollowPlayer:160};break;case 3:this.AIConfig={name:"Very fast but very dumb",wallTouchToAbandonFollowMode:300,randomMovingInterval:500,randomMovingTimeout:8e3,speedIdle:160,speedFollowPlayer:250};break;case 4:this.AIConfig={name:"Intelligent but slow",wallTouchToAbandonFollowMode:75,randomMovingInterval:300,randomMovingTimeout:2e3,speedIdle:100,speedFollowPlayer:130};break;case 5:this.AIConfig={name:"Fast and dump, freak",wallTouchToAbandonFollowMode:225,randomMovingInterval:500,randomMovingTimeout:5e3,speedIdle:150,speedFollowPlayer:175};break;case 6:this.AIConfig={name:"Moving all the time but slowly",wallTouchToAbandonFollowMode:25,randomMovingInterval:750,randomMovingTimeout:3e3,speedIdle:115,speedFollowPlayer:115}}this.logMe("created"),this.sprite.animations.add("walkDown",[0,1,2],10,!0),this.sprite.animations.add("walkRight",[3,4,5],10,!0),this.sprite.animations.add("walkUp",[6,7,8],10,!0),this.sprite.animations.add("walkLeft",[9,10,11],10,!0),this.game.physics.arcade.enable(this.sprite),this.sprite.anchor.setTo(.5,.5),this.followMode=Math.random()>.5,setInterval(function(){i.wallTouchCount=0},1e4)}return t.prototype.logMe=function(t,e){void 0===e&&(e=null),a.DEBUG&&console.log("AI "+this.AIConfig.name+": "+t,e)},t.prototype.onBoundaryCollide=function(t,e){this.followMode&&(this.wallTouchCount++,this.wallTouchCount>=this.AIConfig.wallTouchToAbandonFollowMode&&(this.followMode=!1))},t.prototype.playAnim=function(){var t=0,e="";this.sprite.body.velocity.x>t&&(t=this.sprite.body.velocity.x,e="Right"),this.sprite.body.velocity.x*-1>t&&(t=this.sprite.body.velocity.x*-1,e="Left"),this.sprite.body.velocity.y>t&&(t=this.sprite.body.velocity.y,e="Down"),this.sprite.body.velocity.y*-1>t&&(t=this.sprite.body.velocity.y*-1,e="Up"),this.sprite.play("walk"+e)},t.prototype.onPlayerCollide=function(t,e){var o=this;this.noHurt||(this.noHurt=!0,this.sprite.scale.set(.5,.5),this.sprite.alpha=.75,setTimeout(function(){o.noHurt=!1,o.sprite.scale.set(1,1),o.sprite.alpha=1},3e3),this.gameMgr.onPlayerHurt(),this.followMode=!1,this.game.physics.arcade.moveToXY(this.sprite,Math.round(Math.random()*this.game.world.width),Math.round(Math.random()*this.game.world.height),250),this.playAnim())},t.prototype.makeMoves=function(t,e){var o=this;return this.gameMgr.checkSpriteIsOnFloor(this.sprite)?(this.game.physics.arcade.collide(this.sprite,t,function(t,e){return o.onPlayerCollide(t,e)}),this.game.physics.arcade.collide(this.sprite,e,function(t,e){return o.onBoundaryCollide(t,e)}),void(this.followMode?(this.game.physics.arcade.moveToObject(this.sprite,t,this.AIConfig.speedFollowPlayer),this.playAnim()):this.randomMoves())):this.playAnim()},t.prototype.randomMoves=function(){var t=this;this.movingInterval>0||(this.movingInterval=setInterval(function(){return t._doRandomMove()},this.AIConfig.randomMovingInterval),setTimeout(function(){clearInterval(t.movingInterval),t.movingInterval=0,t.followMode=!0},this.AIConfig.randomMovingTimeout))},t.prototype._doRandomMove=function(){var t=this,e=new Phaser.Point(this.sprite.position.x,this.sprite.position.y);e.add(50,50);var o=this.gameMgr.map.gameXYToMapXY(e);if(this.randomMoveCurrDir&&this.gameMgr.map._hasFloorNeighbor(o,this.randomMoveCurrDir)){var a=new Phaser.Point(this.sprite.position.x,this.sprite.position.y);a.add(this.randomMoveCurrDir.x*i["default"].FLOOR_SIZE_PX,this.randomMoveCurrDir.y*i["default"].FLOOR_SIZE_PX),this.game.physics.arcade.moveToXY(this.sprite,a.x,a.y,this.AIConfig.speedIdle)}else{var n=[new Phaser.Point(1,0),new Phaser.Point((-1),0),new Phaser.Point(0,1),new Phaser.Point(0,(-1))].filter(function(e){return t.gameMgr.map._hasFloorNeighbor(o,e)});0==n.length?this.game.physics.arcade.moveToXY(this.sprite,Math.round(Math.random()*this.game.world.width),Math.round(Math.random()*this.game.world.height),this.AIConfig.speedIdle):(this.randomMoveCurrDir=n[Math.floor(Math.random()*n.length)],this.logMe("initing randomMoveCurrDir",this.randomMoveCurrDir))}this.playAnim()},t}();o.__esModule=!0,o["default"]=n},{"./config":2,"./gameMap":5}],4:[function(t,e,o){"use strict";var i=t("./gameMap"),a=t("./menusInfo"),n=t("./config"),r=function(){function t(){var t=this;this.diamond=null,this.heart=null,this.hpLeft=10,this.currSkill=1,this.points=0,this.level=0,this.preload=function(){t.game.load.image("loader","assets/images/sprites/loader.png"),t.game.load.setPreloadSprite(t.game.add.sprite(Math.round(t.game.width/2-125),Math.round(t.game.height/2-22),"loader"));for(var e={player:["player.png",33,35,12,0],btn:["btn.png",80,57],"btn-small":["btn-small.png",47,33]},o=1;o<=6;o++)e["zombie"+o]=[o+"ZombieSpriteSheet.png",33,36,12,0];t.loadFiles("spritesheet",e,"assets/images/spritesheets/");var i={diamond:"diamond.png",heart:"heart.png","skill-ico":"skill-ico.png","points-ico":"points-ico.png","mana-ico":"mana-ico.png","diamond-ico":"diamond-ico.png","heart-ico":"heart-ico.png","heart-ico-gray":"heart-ico-gray.png",floor:"floor.png",rock:"rock.png","boundary-ver":"boundary-ver.png","boundary-hor":"boundary-hor.png",starfield:"starfield.jpg"};t.loadFiles("image",i,"assets/images/sprites/");var a={"info-delayed":"info-delayed.png","info-enemy":"info-enemy.png","info-info":"info-info.png","info-rocks":"info-rocks.png","info-skill2":"info-skill2.png","info-skill3":"info-skill3.png","info-skills":"info-skills.png","info-story":"info-story.png","info-ui":"info-ui.png","main-menu":"main-menu.png","end-lose":"end-lose.png","end-win":"end-win.png",empty:"empty.png"};t.loadFiles("image",a,"assets/images/infos/");var r={sfx:"sounds.mp3"};t.loadFiles("audio",r,"assets/sounds/");for(var s={},o=1;o<=n.LEVELS_COUNT;o++)s["level"+o]="level"+o+".json";t.loadFiles("json",s,"assets/levels/");var h={credits:"game-credits.txt"};t.loadFiles("text",h,"assets/txts/")},this.create=function(){t.game.physics.startSystem(Phaser.Physics.ARCADE),t.sfx=t.game.add.audio("sfx"),t.sfx.allowMultiple=!0;var e={floor:[0,.389],hurt:[.996,.321],diamond:[2,2.427],level:[5,1.5],soundtrack:[7,17.301,.5],miss:[25,.229]};t.addSoundMarkers(t.sfx,e),setTimeout(function(){t.sfx.play("soundtrack"),setInterval(function(){t.sfx.play("soundtrack")},17301)},1e3),t.menu.showMainMenu()},this.update=function(){try{if(!t.thereIsTheGame||!t.map)return;if(t.game.physics.arcade.collide(t.player,t.boundaries),t.game.physics.arcade.collide(t.player,t.diamond,function(){return t.onDiamonCollide()}),t.game.physics.arcade.collide(t.player,t.heart,function(){return t.onHeartCollide()}),t.enemies.forEach(function(e){e.makeMoves(t.player,t.boundaries)}),t.map.updateGameSprites(t.floors,t.rocks,t.boundaries,t.onFloorCLick),t.map.movementLocked());else{var e=t.translateMovementKeys();0!=e.x||0!=e.y?t.player.body.velocity.set(e.x,e.y):(t.player.body.velocity.x>0&&(t.player.body.velocity.x-=50),t.player.body.velocity.x<0&&(t.player.body.velocity.x+=50),t.player.body.velocity.y>0&&(t.player.body.velocity.y-=50),t.player.body.velocity.y<0&&(t.player.body.velocity.y+=50)),t.checkSpriteIsOnFloor(t.player),t.playPlayerAnimation(),t.bg.z>0&&t.bg.sendToBack()}t.updateGameInfo(),t.stuffToBringUp.forEach(function(t){return t.bringToTop()}),t.debugSpritesBody([{items:[t.player],color:"rgba(0,255,0,0.8)"},{items:t.boundaries,color:"rgba(255,0,0,0.8)"}])}catch(o){console.error(o)}},this.onFloorCLick=function(e){var o=t.map.expandFloors(e.position,t.manaLeft,t.currSkill);0==o&&t.sfx.play("miss"),t.manaLeft+=o},this.game=new Phaser.Game(800,600,Phaser.AUTO,"content",{preload:this.preload,create:this.create,update:this.update}),this.menu=new a["default"](this,this.game),setInterval(function(){t.game.paused||t.manaLeft<t.manaMax&&t.manaLeft++},150),n.DEBUG&&(window.cheat=function(e){t.level=e-1,t.loadNextLevel()},window.cheatScale=function(e){t.game.world.scale.set(e,e)})}return t.prototype.addSoundMarkers=function(t,e){for(var o in e){var i=e[o];t.addMarker.apply(t,[o].concat(i))}},t.prototype.loadFiles=function(t,e,o){void 0===o&&(o="");var i=this.game.load[t].bind(this.game.load);for(var a in e){var n=e[a];if("string"==typeof n)i(a,o+n);else{var r=n.map(function(t,e){return 0==e?o+t:t});i.apply(void 0,[a].concat(r))}}},t.prototype.startGame=function(t){var e=this;void 0===t&&(t=1),this.level=t-1,1==t?this.menu.displayInfo("info-story",function(){e.menu.displayInfo("info-info",function(){e.menu.displayInfo("info-ui",function(){e.loadNextLevel()})})}):this.loadNextLevel(),this.genHPPoint()},t.prototype.genHPPoint=function(){var t=this,e=Math.round(4*this.hpLeft*1e3);setTimeout(function(){if(!t.thereIsTheGame||!t.map||t.game.paused)return t.genHPPoint();if(10==t.hpLeft)return t.genHPPoint();var e=t.map.mapXYToGameXY(t.map.randomFloor());t.heart=t.game.add.sprite(e.x,e.y,"heart"),t._hpSpritePrepare()},e)},t.prototype._hpSpritePrepare=function(){this.heart.anchor.setTo(.5,.5),this.game.physics.arcade.enable(this.heart),this.heart.bringToTop()},t.prototype.checkSpriteIsOnFloor=function(t){var e=new Phaser.Point(t.position.x,t.position.y);e.add(50,50);var o=this.map.gameXYToMapXY(e);if(!this.map.getIsFloor(o)){var i=t.body.velocity,a=new Phaser.Point(0,0);return 0==i.x&&i.y?a.add(Math.random()>.5?50:-50,Math.random()>.5?50:-50):a.add(i.x>-50&&i.x<-50?0:i.x>0?-50:50,i.y>-50&&i.y<-50?0:i.y>0?-50:50),t.position.add(a.x,a.y),!1}return!0},t.prototype.loadNextLevel=function(){var t=this;if(this.thereIsTheGame=!1,this.map&&this.map.destroy(),this.map=null,this.floors=[],this.rocks=[],this.boundaries=[],this.enemies=[],this.stuffToBringUp=[],this.diamonds=0,this.game.world.removeAll(!0),this.level+1>=n.LEVELS_COUNT)return this.menu.displayInfo("end-win",null),void this.menu.addBtn(new Phaser.Point(360,435),"Survey",function(){window.location.assign("https://jakubkrol.typeform.com/to/uaVHvV")});var e=function(){t.bg=t.game.add.tileSprite(0,0,t.game.width,t.game.height,"starfield"),t.bg.fixedToCamera=!0,t.bg.sendToBack(),t.player=t.game.add.sprite(-10,-10,"player"),t.player.animations.add("walkDown",[0,1,2],10,!0),t.player.animations.add("walkRight",[3,4,5],10,!0),t.player.animations.add("walkUp",[6,7,8],10,!0),t.player.animations.add("walkLeft",[9,10,11],10,!0),t.game.physics.arcade.enable(t.player),t.player.anchor.setTo(.5,.5),t.game.camera.follow(t.player,Phaser.Camera.FOLLOW_LOCKON,.1,.1),t.level++,t.levelData=t.game.cache.getJSON("level"+t.level),t.manaMax=parseInt(t.levelData.manaMax+""),t.manaLeft=t.manaMax,t.map=new i["default"](t,t.game,t.player,t.enemies,t.levelData.data),t._genUI(),t.thereIsTheGame=!0};this._showInfos(e)},t.prototype._showInfos=function(t){var e={1:"info-skills",3:"info-enemy",4:"info-rocks",5:"info-delayed",9:"info-skill2",19:"info-skill3"},o=e[this.level];o?this.menu.displayInfo(o,t):t()},t.prototype._genUI=function(){this.diamondsInfo=this._gen1UIEl(30,30,"diamond-ico",10,30),this.manaInfo=this._gen1UIEl(100,30,"mana-ico",80,30),this.skillInfo=this._gen1UIEl(30,50,"skill-ico",10,50),this.pointsInfo=this._gen1UIEl(100,50,"points-ico",80,50),this.gameInfo=this._gen1UIEl(10,70),this._updateHeartIcos()},t.prototype._gen1UIEl=function(t,e,o,i,a,n){if(void 0===o&&(o=""),void 0===i&&(i=0),void 0===a&&(a=0),void 0===n&&(n=!0),o){var r=this.game.add.sprite(i,a,o);r.fixedToCamera=!0,n&&this.stuffToBringUp.push(r)}var s=this.game.add.text(t,e,"",{font:"16px Arial",fill:"#ffffff",align:"center"});return s.fixedToCamera=!0,n&&this.stuffToBringUp.push(s),s},t.prototype.updateGameInfo=function(){this.gameInfo.text="#"+this.level+': "'+this.levelData.name+'"',this.diamondsInfo.text=this.diamonds+"/"+this.levelData.diamondsToWin,this.manaInfo.text=this.manaLeft+"/"+this.manaMax,this.skillInfo.text="["+this.currSkill+"]",this.pointsInfo.text=""+this.points},t.prototype.playPlayerAnimation=function(){var t=0,e="";this.player.body.velocity.x>t&&(t=this.player.body.velocity.x,e="Right"),this.player.body.velocity.x*-1>t&&(t=this.player.body.velocity.x*-1,e="Left"),this.player.body.velocity.y>t&&(t=this.player.body.velocity.y,e="Down"),this.player.body.velocity.y*-1>t&&(t=this.player.body.velocity.y*-1,e="Up"),t>0?this.player.play("walk"+e):this.player.animations.stop()},t.prototype.onDiamonCollide=function(){this.game.camera.flash(204,200),this.sfx.play("diamond"),this.diamonds+=1,this.points+=100,this.manaLeft+=100,this.manaLeft=Math.min(this.manaLeft,this.manaMax),this.map.genDiamond(),this.diamonds>=parseInt(this.levelData.diamondsToWin+"")&&this._levelWon()},t.prototype._levelWon=function(){store.set("lp"+this.level,!0),this.sfx.play("level"),this.loadNextLevel()},t.prototype.onHeartCollide=function(){this.heart.destroy(),this.game.camera.flash(12255402,200),this.sfx.play("diamond"),this.points+=100,this.hpLeft+=1,this.hpLeft=Math.min(this.hpLeft,10),this._updateHeartIcos(),this.genHPPoint()},t.prototype.onPlayerHurt=function(){this.game.camera.flash(16711680,500),this.sfx.play("hurt"),this.points-=100,this.hpLeft-=1,this.manaLeft-=100,this.manaLeft=Math.max(this.manaLeft,0),this._updateHeartIcos(),this.hpLeft<=0&&(this.game.world.removeAll(!0),this.menu.displayInfo("end-lose",function(){location.reload()}))},t.prototype._updateHeartIcos=function(){this.heartsIcos&&this.heartsIcos.forEach(function(t){t.destroy()}),this.heartsIcos=[];for(var t=0;t<10;t++){var e=this.game.add.sprite(10+(16*t+5),10,"heart-ico"+(t<this.hpLeft?"":"-gray"));e.fixedToCamera=!0,this.heartsIcos.push(e),this.stuffToBringUp.push(e)}},t.prototype.debugSpritesBody=function(t){var e=this;n.DEBUG&&t.forEach(function(t){t.items.forEach(function(o){e.game.debug.body(o,t.color)})})},t.prototype.translateMovementKeys=function(){var t={LEFT:"x-300",RIGHT:"x300",UP:"y-300",DOWN:"y300",A:"x-300",D:"x300",W:"y-300",S:"y300"},e={ONE:1,TWO:2,THREE:3},o={ONE:0,TWO:10,THREE:20},i={x:0,y:0};for(var a in t)this.game.input.keyboard.isDown(Phaser.KeyCode[a])&&(i[t[a][0]]+=parseInt(t[a].substr(1)));i.x=Math.max(Math.min(i.x,500),-500),i.y=Math.max(Math.min(i.y,500),-500);for(var a in e)this.level>=o[a]&&this.game.input.keyboard.isDown(Phaser.KeyCode[a])&&(this.currSkill=e[a]);return i},t}();o.__esModule=!0,o["default"]=r},{"./config":2,"./gameMap":5,"./menusInfo":6}],5:[function(t,e,o){"use strict";var i=t("./enemy"),a=function(){function t(e,o,i,a,n){var r=this;this.gameMgr=e,this.game=o,this.mapAr=[],this.rocksAr=[],this.floorDelays=[],this.floorDelaysMap={},this.applyMapData(this.createBoundsWalls(n),i,a),console.log("Game data",this.mapAr),this.game.world.setBounds(0,0,this.width*t.FLOOR_SIZE_PX,this.height*t.FLOOR_SIZE_PX),this.genDiamondInterval=setInterval(function(){return r.genDiamond()},3e4),this.genDiamond()}return t.prototype.getIsFloor=function(t){return this.mapAr[t.y][t.x]},t.prototype.destroy=function(){clearInterval(this.genDiamondInterval)},t.prototype.createBoundsWalls=function(t){for(var e=t[0].length,o="",i=1;i<=e+2;i++)o+="5";return t.forEach(function(e,o){t[o]="5"+e+"5"}),t.unshift(o),t.push(o),t},t.prototype.genDiamond=function(){this.gameMgr.diamond&&this.gameMgr.diamond.destroy();var t=this.mapXYToGameXY(this.randomFloor());this.gameMgr.diamond=this.game.add.sprite(t.x,t.y,"diamond"),this._diamondSpritePrepare(this.gameMgr.diamond)},t.prototype._diamondSpritePrepare=function(t){t.anchor.setTo(.5,.5),this.game.physics.arcade.enable(t),t.bringToTop()},t.prototype.randomFloor=function(){for(;;){var t=new Phaser.Point(Math.round(Math.random()*(this.width-1)),Math.round(Math.random()*(this.height-1)));if(this.mapAr[t.y][t.x])return t}},t.prototype.setFloor=function(t,e){if(t.x<0||t.y<0||t.x>this.width-1||t.y>this.height-1)throw"Cannot set floor not in range! Required position: "+t.y+"x"+t.x+", game map height: "+this.height+", width: "+this.width;if(this.rocksAr[t.y][t.x])throw"Cannot place floor where rock is.";this.mapAr[t.y][t.x]=e,e&&this.pushFloorDelay(t)},t.prototype.addFloor=function(t){this.setFloor(t,!0)},t.prototype.removeFloor=function(t){this.setFloor(t,!1)},t.prototype.setRock=function(t,e){if(t.x<0||t.y<0||t.x>this.width-1||t.y>this.height-1)throw"Cannot set rock not in range! Required position: "+t.y+"x"+t.x+", game map height: "+this.height+", width: "+this.width;this.rocksAr[t.y][t.x]=e},t.prototype.addRock=function(t){this.setRock(t,!0)},t.prototype.removeRock=function(t){this.setRock(t,!1)},t.prototype.movementLocked=function(){return this.lockMovement},t.prototype.updateGameSprites=function(t,e,o,i){var a=this,n=this.checkAndBuildElements(t,this.mapAr,"floor",function(t,e,o){return a._floorSpritePrepare(t,e,o,i)})||this.checkAndBuildElements(e,this.rocksAr,"rock",function(t){return a._rockSpritePrepare(t)});n&&(this.floorDelays=[],this.floorDelaysMap={},this.makeBoundaries(o))},t.prototype.checkAndBuildElements=function(t,e,o,i){var a=this,n=[],r=[],s={},h=!1;return n=this.fillArr(this.width,this.height),r=this.fillArr(this.width,this.height),t.forEach(function(t,e){var o=a.gameXYToMapXY(t.position);n[o.y][o.x]=!0,r[o.y][o.x]=t,s[o.y+"x"+o.x]=e}),e.forEach(function(e,l){e.forEach(function(e,d){if(e!=n[l][d])if(h=!0,e){var p=a.mapXYToGameXY(new Phaser.Point(d,l)),u=a.game.add.sprite(p.x,p.y,o);i(u,d,l),t.push(u)}else r[l][d].destroy(),t.splice(s[l+"x"+d],1)})}),h},t.prototype.expandFloors=function(t,e,o){var i=this.gameXYToMapXY(t),a={RIGHT:!this._hasFloorNeighbor(i,new Phaser.Point(1,0),!0),LEFT:!this._hasFloorNeighbor(i,new Phaser.Point((-1),0),!0),BOTTOM:!this._hasFloorNeighbor(i,new Phaser.Point(0,1),!0),TOP:!this._hasFloorNeighbor(i,new Phaser.Point(0,(-1)),!0)},n=function(){for(var t="";!t;){var e=0,o=Math.round(4*Math.random());for(var i in a){if(o==e&&a[i]){t=i;break}e++}}return t},r=function(t){switch(t){case"RIGHT":return new Phaser.Point(i.x+1,i.y+0);case"LEFT":return new Phaser.Point(i.x-1,i.y+0);case"BOTTOM":return new Phaser.Point(i.x+0,i.y+1);case"TOP":return new Phaser.Point(i.x+0,i.y-1)}},s=!1;for(var h in a)if(a[h]){s=!0;break}if(!s)return 0;var l=n();switch(o){case 1:if(e<10)return 0;try{this.addFloor(r(l))}catch(d){}return this.game.camera.shake(.005,150),-10;case 2:if(e<35)return 0;var p=0,u=0;switch(l){case"RIGHT":p=1,u=0;break;case"LEFT":p=-1,u=0;break;case"BOTTOM":p=0,u=1;break;case"TOP":p=0,u=-1}var c=Math.round(3*Math.random()+2),f=0,m=0;try{for(var y=1;y<=c;y++)f+=p,m+=u,this.addFloor(new Phaser.Point(i.x+f,i.y+m))}catch(d){}return this.game.camera.shake(.025,100*c),-35;case 3:if(e<80)return 0;for(var g=Math.round(2*Math.random()+1),y=1;y<=g;y++)for(var v=-1;v<=1;v++)for(var w=-1;w<=1;w++){var M=new Phaser.Point(i.x+w*y,i.y+v*y);try{this.addFloor(M)}catch(d){}}return this.game.camera.shake(.05,200*g),-80}},t.prototype.makeBoundaries=function(t){var e=this;this.lockMovement=!0,t.forEach(function(t){t.destroy()}),t.splice(0),this.mapAr.forEach(function(o,i){o.forEach(function(o,a){o&&(e._hasFloorNeighbor(new Phaser.Point(a,i),new Phaser.Point(1,0))||t.push(e._insertBoundary(e.mapXYToGameXY(new Phaser.Point(a,i)),"RIGHT")),e._hasFloorNeighbor(new Phaser.Point(a,i),new Phaser.Point((-1),0))||t.push(e._insertBoundary(e.mapXYToGameXY(new Phaser.Point(a,i)),"LEFT")),e._hasFloorNeighbor(new Phaser.Point(a,i),new Phaser.Point(0,1))||t.push(e._insertBoundary(e.mapXYToGameXY(new Phaser.Point(a,i)),"BOTTOM")),e._hasFloorNeighbor(new Phaser.Point(a,i),new Phaser.Point(0,(-1)))||t.push(e._insertBoundary(e.mapXYToGameXY(new Phaser.Point(a,i)),"TOP")))})}),setTimeout(function(){e.lockMovement=!1},10)},t.prototype._insertBoundary=function(t,e){var o,i;switch(e){case"RIGHT":o=new Phaser.Point(45,0),i="boundary-ver";break;case"LEFT":o=new Phaser.Point((-45),0),i="boundary-ver";break;case"BOTTOM":o=new Phaser.Point(0,45),i="boundary-hor";break;case"TOP":o=new Phaser.Point(0,(-45)),i="boundary-hor"}o.add(t.x,t.y);var a=this.game.add.sprite(o.x,o.y,i);return a.anchor.setTo(.5,.5),this.game.physics.arcade.enable(a),a.body.immovable=!0,a},t.prototype._hasFloorNeighbor=function(t,e,o,i){void 0===o&&(o=!1),void 0===i&&(i=!1);var a=new Phaser.Point(t.x,t.y);return a.add(e.x,e.y),a.x<0||a.y<0||a.x>this.width-1||a.y>this.height-1?i:this.mapAr[a.y][a.x]||o&&this.rocksAr[a.y][a.x]},t.prototype._rockSpritePrepare=function(t){t.anchor.setTo(.5,.5),t.sendToBack()},t.prototype._floorSpritePrepare=function(t,e,o,i){var a=this;switch(t.scale.set(0,0),t.anchor.setTo(.5,.5),Math.round(4*Math.random())){case 0:t.angle=0;break;case 1:t.angle=90;break;case 2:t.angle=-90;break;case 3:t.angle=180}t.sendToBack(),t.inputEnabled=!0,t.events.onInputDown.add(i),setTimeout(function(){a.gameMgr.sfx.play("floor")},this.floorDelays[this.floorDelaysMap[o+"x"+e]]),this.game.add.tween(t.scale).to({x:1,y:1},1e3,Phaser.Easing.Bounce.Out,!0,this.floorDelays[this.floorDelaysMap[o+"x"+e]])},t.prototype.pushFloorDelay=function(t){var e=0==this.floorDelays.length?0:this.floorDelays[this.floorDelays.length-1]+100;this.floorDelays.push(e),this.floorDelaysMap[t.y+"x"+t.x]=this.floorDelays.length-1},t.prototype.applyMapData=function(t,e,o){var a=this;this.height=t.length,this.width=t[0].length,this.mapAr=this.fillArr(this.width,this.height),this.rocksAr=this.fillArr(this.width,this.height),t.forEach(function(t,n){for(var r=function(r,s){var h=parseInt(t[r]);switch(h){case 2:e.position=a.mapXYToGameXY(new Phaser.Point(r,n));case 1:a.addFloor(new Phaser.Point(r,n));break;case 3:setTimeout(function(){a.addFloor(new Phaser.Point(r,n))},3e3);break;case 4:setTimeout(function(){a.addFloor(new Phaser.Point(r,n))},1e4);break;case 5:a.addRock(new Phaser.Point(r,n));break;case 6:a.addFloor(new Phaser.Point(r,n)),o.push(new i["default"](a.gameMgr,a.game,a.mapXYToGameXY(new Phaser.Point(r,n))))}},s=0,h=t.length;s<h;s++)r(s,h)})},t.prototype.fillArr=function(t,e){return Array(e).fill(Array(t).fill(!1))},t.prototype.mapXYToGameXY=function(e){return new Phaser.Point(e.x*t.FLOOR_SIZE_PX+Math.round(t.FLOOR_SIZE_PX/2),e.y*t.FLOOR_SIZE_PX+Math.round(t.FLOOR_SIZE_PX/2))},t.prototype.gameXYToMapXY=function(e){return new Phaser.Point(Math.floor((e.x-Math.round(t.FLOOR_SIZE_PX/2))/t.FLOOR_SIZE_PX),Math.floor((e.y-Math.round(t.FLOOR_SIZE_PX/2))/t.FLOOR_SIZE_PX))},t.FLOOR_SIZE_PX=100,t}();o.__esModule=!0,o["default"]=a},{"./enemy":3}],6:[function(t,e,o){"use strict";var i=t("./config"),a=function(){function t(t,e){this.gameMgr=t,this.game=e,this.infoSprite=null}return t.prototype.showMainMenu=function(){var t=this;this.displayInfo("main-menu",null),this._buildLevelBtns(),this.addBtn(new Phaser.Point(590,430),"Credits",function(){return t._creditsInfo()})},t.prototype._buildLevelBtns=function(){for(var t=this,e=new Phaser.Point(120,250),o=540,a=180,n=10,r=Math.ceil(i.LEVELS_COUNT/n),s=Math.round(a/r),h=Math.round(o/n),l=Math.round((s-33)/2),d=Math.round((h-47)/2),p=0,u=0,c=function(o){u++,11==u&&(p++,u=1);var i=new Phaser.Point(e.x+d+d+47*(u-1)+2*d*(u-1),e.y+l+l+33*p+2*l*p);f.addBtn(i,o+"",function(){return t._onLevelBtnClick(o)},!0,1==o||store.get("lp"+(o-1),!1))},f=this,m=1;m<=i.LEVELS_COUNT;m++)c(m)},t.prototype._creditsInfo=function(){var t=this;this.displayInfo("empty",function(){return t.showMainMenu()});var e=this.game.add.text(0,0,this.game.cache.getText("credits"),{boundsAlignV:"middle",wordWrap:!0,wordWrapWidth:525,fontSize:"14px"});e.setTextBounds(120,80,525,380)},t.prototype._onLevelBtnClick=function(t){this.gameMgr.startGame(t)},t.prototype.addBtn=function(t,e,o,i,a){void 0===o&&(o=null),void 0===i&&(i=!1),void 0===a&&(a=!0);var n=(a?this.game.add.button(t.x,t.y,i?"btn-small":"btn",o,this,1,0,2):this.game.add.button(t.x,t.y,i?"btn-small":"btn",null,this,3,3,3,3),this.game.add.text(t.x,t.y,e,{boundsAlignH:"center",boundsAlignV:"middle",fontSize:"20px"}));n.setTextBounds(0,0,i?47:80,i?40:60)},t.prototype.displayInfo=function(t,e){var o=this;this.infoSprite=this.game.add.sprite(0,0,t);var i=this.game.width/2-this.infoSprite.width/2,a=this.game.height/2-this.infoSprite.height/2;this.infoSprite.position.set(i,a),this.infoSprite.inputEnabled=!0,setTimeout(function(){o.infoSprite.events.onInputDown.add(function(){return o.onInfoClick()})},700),this.infoSprite.bringToTop(),this.game.world.width=800,this.game.world.height=600,this.game.camera.follow(this.infoSprite),this.infoClb=e},t.prototype.onInfoClick=function(){this.infoClb&&(this.game.lockRender=!1,this.infoSprite.destroy(),this.infoSprite=null,this.infoClb())},t}();o.__esModule=!0,o["default"]=a},{"./config":2}],7:[function(t,e,o){Array.prototype.fill||(Array.prototype.fill=function(t){if(null==this)throw new TypeError("this is null or not defined");for(var e=Object(this),o=e.length>>>0,i=arguments[1],a=i>>0,n=a<0?Math.max(o+a,0):Math.min(a,o),r=arguments[2],s=void 0===r?o:r>>0,h=s<0?Math.max(o+s,0):Math.min(s,o);n<h;)e[n]=t,n++;return e})},{}],8:[function(t,e,o){},{}],9:[function(t,e,o){arguments[4][8][0].apply(o,arguments)},{dup:8}],10:[function(t,e,o){arguments[4][8][0].apply(o,arguments)},{dup:8}],11:[function(t,e,o){arguments[4][8][0].apply(o,arguments)},{dup:8}],12:[function(t,e,o){arguments[4][8][0].apply(o,arguments)},{dup:8}],13:[function(t,e,o){arguments[4][8][0].apply(o,arguments)},{dup:8}],14:[function(t,e,o){arguments[4][8][0].apply(o,arguments)},{dup:8}],15:[function(t,e,o){arguments[4][8][0].apply(o,arguments)},{dup:8}]},{},[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15]);